
node() {

    executeStage("Checkout Source") {
         checkout([$class: 'GitSCM', branches: [[name: '*/develop']], browser: [$class: 'GithubWeb', repoUrl: 'https://github.com/wxj19880511/JenkinsSharedLibary.git'], doGenerateSubmoduleConfigurations: false, extensions: [[$class: 'ScmName', name: 'JenkinsSharedLibrary']], submoduleCfg: [], userRemoteConfigs: [[credentialsId: 'github', url: 'https://github.com/wxj19880511/JenkinsSharedLibary.git']]])
    }

    executeStage("Test load class library from frolder") {
        sh "ls -alt"
        def library = pwd() + '/workflows/Animal/library/Animal.groovy'
        def lib = load "${library}"
        lib.test()
    }


    executeStage("Test shared library class") {
        def test = new org.foo.Point(this)
        test.pwd()
            def obj = org.foo.Point()
            obj.setX(3)
            println(obj.getX())
    }

 

    Animal {
        food = 'meat'
    }

    executeWithDocker {

        executeStage("Test") {
            echo "This is only a basic test"
            sh " ls -alt"    
            lib.test()  
        }

        executeStage("Build") {
            echo "This is only a basic test"
            sh " ls -alt"      
        }

        executeStage("Deploy") {
            echo "This is only a basic test"
            sh " ls -alt"   
        }
    }
}